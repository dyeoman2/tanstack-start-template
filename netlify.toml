[build]
  command = "echo 'ğŸ—ï¸ Starting build process...' && echo 'ğŸš€ Deploying Convex functions and building application...' && npx convex deploy --cmd 'pnpm build' && echo 'ğŸ‰ Build completed successfully'"
  publish = "dist/client"

[build.environment]
  NODE_VERSION = "24"
  SECRETS_SCAN_OMIT_KEYS = "VITE_CONVEX_SITE_URL"

# Deploy previews skip Convex deployment (use preview deployment instead)
[context.deploy-preview]
  command = "echo 'ğŸ—ï¸ Building preview (skipping Convex deploy)...' && pnpm build && echo 'ğŸ‰ Preview build completed successfully'"

[context.deploy-preview.environment]
  VITE_CONVEX_SITE_URL = "https://striped-cheetah-712.convex.cloud"
  CONVEX_URL = "https://striped-cheetah-712.convex.cloud"

[template]
  full = true

[[template.environment]]
name = "CONVEX_DEPLOY_KEY"
required = true
default = ""
description = "Production deploy key from Convex Dashboard (Settings â†’ Deploy Keys â†’ Production). Required for deploying Convex functions during Netlify build."
